<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Posts about dtreeviz | Step-by-step Data Science</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#4285F4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href=".">
<link rel="icon" href="images/LogoMakr_2dGBSO.png" sizes="16x16">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-134273341-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134273341-1');
</script><link rel="alternate" type="application/rss+xml" title="RSS for tag dtreeviz" hreflang="en" href="../dtreeviz.xml">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../">

                <span id="blog-title">Step-by-step Data Science</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../coding">Algorithms and Data Structures</a>
                </li>
<li>
<a href="../machine-learning">Machine Learning</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">All <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../posts/">All Post</a>
                    </li>
<li>
<a href="../">Categories and Tags</a>
                    </li>
<li>
<a href="../../archive.html">History</a>
            </li>
</ul>
</li>
<li>
<a href="../../rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    <header><h1>Posts about dtreeviz</h1>
        <div class="metadata">
            
                <p class="feedlink">
                        
            <a href="../dtreeviz.xml" hreflang="en" type="application/rss+xml">RSS feed</a>

                </p>

            

        </div>
    </header><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/split-up-dtreeviz-part-5/" class="u-url">Split Up: dtreeviz (Part 5)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/split-up-dtreeviz-part-5/" rel="bookmark">
            <time class="published dt-published" datetime="2019-07-21T01:40:22-07:00" itemprop="datePublished" title="Jul 21, 2019, 1:40:22 AM">Jul 21, 2019, 1:40:22 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/split-up-dtreeviz-part-5/#disqus_thread" data-disqus-identifier="cache/posts/split-up-dtreeviz-part-5.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-5/#Goal">¶</a>
</h2>
<p>This post aims to break down the module <a href="https://github.com/parrt/dtreeviz"><code>dtreeviz</code></a> module step by step to fully understand what is implemented. After fully understanding this, I would like to contribute to this module and submit a pull request.</p>
<p>I really like this module and would like to see this works for other tree-based modules like XGBoost or Lightgbm. I found <a href="https://github.com/parrt/dtreeviz/issues/15">the exact same issue (issues 15)</a> in github so I hope I could contribute to this issue.</p>
<p>This post is the 5th part:</p>
<ul>
<li><code>ctreeviz_univar</code></li>
</ul>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://github.com/parrt/dtreeviz">Github dtreeviz</a></li>
<li><a href="https://scikit-learn.org/stable/modules/tree.html">Scikit-Learn - Tree</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-1/">Step by Step Data Science - Split-Up: dtreeviz (Part 1)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-2/">Step by Step Data Science - Split-Up: dtreeviz (Part 2)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-3/">Step by Step Data Science - Split-Up: dtreeviz (Part 3)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-4/">Step by Step Data Science - Split-Up: dtreeviz (Part 4)</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="trees.ctreeviz_univar">
<code>trees.ctreeviz_univar</code><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-5/#trees.ctreeviz_univar">¶</a>
</h2>
<ul>
<li>L267: the beginning of the definition for <code>ctreeviz_univar</code>
</li>
<li>L272-275: treatment for pandas input</li>
<li>L277: load color property</li>
<li>L280-288: load decision tree classifier object as shadow_tree and other relevant attributes e.g., # of class, target values.</li>
<li>L290-302: setting labels and spines visibility</li>
<li>L304-319: plotting stacked bar chart with histogram when <code>gtype=='barstacked'</code>
</li>
<li>L320-330: plotting scatter plot with gitter </li>
<li>L332: setting tick parameters</li>
<li>L352-353: setting legend</li>
<li>L355-358: setting a title</li>
<li>L360-362: setting <code>splits</code> vertical line between categories</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">graphviz.backend</span> <span class="k">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">view</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="k">import</span> <span class="n">platform</span> <span class="k">as</span> <span class="n">PLATFORM</span>
<span class="kn">from</span> <span class="nn">colour</span> <span class="k">import</span> <span class="n">Color</span><span class="p">,</span> <span class="n">rgb2hex</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dtreeviz.utils</span> <span class="k">import</span> <span class="n">inline_svg_images</span><span class="p">,</span> <span class="n">myround</span>
<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="n">ShadowDecTree</span><span class="p">,</span> <span class="n">ShadowDecTreeNode</span>
<span class="kn">from</span> <span class="nn">dtreeviz.colors</span> <span class="k">import</span> <span class="n">adjust_colors</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">graphviz</span>

<span class="kn">from</span> <span class="nn">dtreeviz.trees</span> <span class="k">import</span> <span class="o">*</span>

<span class="c1"># How many bins should we have based upon number of classes</span>
<span class="n">NUM_BINS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
          <span class="c1"># 0, 1, 2,  3, 4, 5, 6, 7, 8, 9, 10</span>

<span class="k">def</span> <span class="nf">ctreeviz_univar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span>
                    <span class="n">target_name</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s2">"Arial"</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">gtype</span><span class="o">=</span><span class="s1">'strip'</span><span class="p">,</span>
                    <span class="n">show</span><span class="o">=</span><span class="p">{</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'legend'</span><span class="p">,</span><span class="s1">'splits'</span><span class="p">},</span>
                    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">adjust_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

    <span class="c1">#    ax.set_facecolor('#F9F9F9')</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
    <span class="n">ct</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">shadow_tree</span> <span class="o">=</span> <span class="n">ShadowDecTree</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span>
                                <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="n">feature_name</span><span class="p">],</span> <span class="n">class_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>

    <span class="n">n_classes</span> <span class="o">=</span> <span class="n">shadow_tree</span><span class="o">.</span><span class="n">nclasses</span><span class="p">()</span>
    <span class="n">overall_feature_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_train</span><span class="p">))</span>
    <span class="n">class_values</span> <span class="o">=</span> <span class="n">shadow_tree</span><span class="o">.</span><span class="n">unique_target_values</span>
    <span class="n">color_values</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="s1">'classes'</span><span class="p">][</span><span class="n">n_classes</span><span class="p">]</span>
    <span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">color_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_values</span><span class="p">)}</span>
    <span class="n">X_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="p">[</span><span class="n">cl</span><span class="p">]</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">class_values</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">f</span><span class="s2">"</span><span class="si">{feature_name}</span><span class="s2">"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'axis_label'</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'top'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'right'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'left'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'bottom'</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">X_hist</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">cl</span><span class="p">]</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">class_values</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">gtype</span> <span class="o">==</span> <span class="s1">'barstacked'</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">barcontainers</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_hist</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="n">X_colors</span><span class="p">,</span>
                                            <span class="n">align</span><span class="o">=</span><span class="s1">'mid'</span><span class="p">,</span>
                                            <span class="n">histtype</span><span class="o">=</span><span class="s1">'barstacked'</span><span class="p">,</span>
                                            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
                                            <span class="n">label</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">patch</span> <span class="ow">in</span> <span class="n">barcontainers</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">patch</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
                <span class="n">rect</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
                <span class="n">rect</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="s1">'edge'</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">overall_feature_range</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">overall_feature_range</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hist</span><span class="p">])])</span>
    <span class="k">elif</span> <span class="n">gtype</span> <span class="o">==</span> <span class="s1">'strip'</span><span class="p">:</span>
        <span class="c1"># user should pass in short and wide fig</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">013</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="o">.</span><span class="mi">08</span>
        <span class="n">class_step</span> <span class="o">=</span> <span class="o">.</span><span class="mi">08</span>
        <span class="n">dot_w</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">n_classes</span><span class="o">*</span><span class="n">class_step</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'X_hist'</span><span class="p">,</span> <span class="n">X_hist</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_hist</span><span class="p">):</span>
            <span class="n">y_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">class_step</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bucket</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">y_noise</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">dot_w</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                       <span class="n">edgecolors</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'scatter_edge'</span><span class="p">],</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span> <span class="n">width</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'tick_label'</span><span class="p">],</span>
                   <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">shadow_tree</span><span class="o">.</span><span class="n">internal</span><span class="p">]</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">splits</span><span class="p">)</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">splits</span> <span class="o">+</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="n">pred_box_height</span> <span class="o">=</span> <span class="o">.</span><span class="mi">07</span> <span class="o">*</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">inrange</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[(</span><span class="n">x_train</span> <span class="o">&gt;=</span> <span class="n">left</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_train</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">)]</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">inrange</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">left</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">),</span> <span class="n">pred_box_height</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span>
                                 <span class="n">edgecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'edge'</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">pred</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'legend'</span> <span class="ow">in</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">add_classifier_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="n">class_values</span><span class="p">,</span> <span class="n">color_map</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'title'</span> <span class="ow">in</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">accur</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"Classifier tree depth </span><span class="si">{max_depth}</span><span class="s2">, training accuracy={accur*100:.2f}%"</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'title'</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">'splits'</span> <span class="ow">in</span> <span class="n">show</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">split</span><span class="p">,</span> <span class="n">split</span><span class="p">],</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'split_line'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-toy-classification-example">Create a toy classification example<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-5/#Create-a-toy-classification-example">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">graphviz</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">'X'</span><span class="p">:</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="s1">'Y'</span><span class="p">:</span> <span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()},</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'bar'</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Sample Data for Univariate Regression'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualize-classification-tree-for-univariate-case">Visualize classification tree for univariate case<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-5/#Visualize-classification-tree-for-univariate-case">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ctreeviz_univar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> 
                <span class="n">feature_name</span><span class="o">=</span><span class="s1">'X'</span><span class="p">,</span> 
                <span class="n">target_name</span><span class="o">=</span><span class="s1">'Y'</span><span class="p">,</span>
                <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
                <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">],</span> 
                <span class="n">gtype</span> <span class="o">=</span> <span class="s1">'barstacked'</span><span class="p">,</span>
                <span class="n">show</span><span class="o">=</span><span class="p">{</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'splits'</span><span class="p">}</span>
               <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note</strong>
When I apply <code>show={'legend'}</code>, I obtained the error below and still not figured out yet what was wrong.</p>
<div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span>                                  <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">42</span><span class="o">-</span><span class="n">c31e8b14db34</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">4</span>                 <span class="n">target_name</span><span class="o">=</span><span class="s1">'Y'</span><span class="p">,</span>
      <span class="mi">5</span>                 <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">----&gt;</span> <span class="mi">6</span>                 <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">]</span>
      <span class="mi">7</span>                <span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">41</span><span class="o">-</span><span class="n">b466a69d927c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">ctreeviz_univar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">fontname</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">gtype</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
     <span class="mi">85</span>         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_hist</span><span class="p">):</span>
     <span class="mi">86</span>             <span class="n">y_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">class_step</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bucket</span><span class="p">))</span>
<span class="o">---&gt;</span> <span class="mi">87</span>             <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span> <span class="n">y_noise</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">dot_w</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
     <span class="mi">88</span>                        <span class="n">edgecolors</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'scatter_edge'</span><span class="p">],</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>
     <span class="mi">89</span> 

<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>

</div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/split-up-dtreeviz-part-4/" class="u-url">Split Up: dtreeviz (Part 4)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/split-up-dtreeviz-part-4/" rel="bookmark">
            <time class="published dt-published" datetime="2019-07-20T13:51:36-07:00" itemprop="datePublished" title="Jul 20, 2019, 1:51:36 PM">Jul 20, 2019, 1:51:36 PM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/split-up-dtreeviz-part-4/#disqus_thread" data-disqus-identifier="cache/posts/split-up-dtreevis-part-4.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-4/#Goal">¶</a>
</h2>
<p>This post aims to break down the module <a href="https://github.com/parrt/dtreeviz"><code>dtreeviz</code></a> module step by step to fully understand what is implemented. After fully understanding this, I would like to contribute to this module and submit a pull request.</p>
<p>I really like this module and would like to see this works for other tree-based modules like XGBoost or Lightgbm. I found <a href="https://github.com/parrt/dtreeviz/issues/15">the exact same issue (issues 15)</a> in github so I hope I could contribute to this issue.</p>
<p>This post is the 4th part: breaking down <code>DTreeViz</code> class and <code>rtreeviz_univar</code> method.</p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://github.com/parrt/dtreeviz">Github dtreeviz</a></li>
<li><a href="https://scikit-learn.org/stable/modules/tree.html">Scikit-Learn - Tree</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-1/">Step by Step Data Science - Split-Up: dtreeviz (Part 1)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-2/">Step by Step Data Science - Split-Up: dtreeviz (Part 2)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-3/">Step by Step Data Science - Split-Up: dtreeviz (Part 3)</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DTreeViz-class">
<code>DTreeViz</code> class<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-4/#DTreeViz-class">¶</a>
</h2>
<ul>
<li>L23: the beginning of <code>DTreeViz</code> class</li>
<li>L24-25: <code>__init__</code> method taking <code>dot</code> object as an input </li>
<li>L26-78: deal with save, view the visualization as svg file </li>
</ul>
<h3 id="rtreeviz_univar">rtreeviz_univar<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-4/#rtreeviz_univar">¶</a>
</h3>
<ul>
<li>L81: the beginning of <code>rtreeviz_univar</code> method</li>
<li>L94-102: initial setting for the range of X, y data and converting them into numpy array.</li>
<li>L104-105: create a scikit-learn decision tree</li>
<li>L121-122: plot the original X and y data points</li>
<li>L125-126: plot the vertical line for decision boundary (gray line)</li>
<li>L128-134: plot the horizontal line for mean line (red line by default)</li>
<li>L136: Change the appearance of ticks</li>
<li>L138-140: setting title</li>
<li>L142-143: setting x and y label based on <code>feature_name</code> and <code>target_name</code>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">graphviz.backend</span> <span class="k">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">view</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="k">import</span> <span class="n">platform</span> <span class="k">as</span> <span class="n">PLATFORM</span>
<span class="kn">from</span> <span class="nn">colour</span> <span class="k">import</span> <span class="n">Color</span><span class="p">,</span> <span class="n">rgb2hex</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dtreeviz.utils</span> <span class="k">import</span> <span class="n">inline_svg_images</span><span class="p">,</span> <span class="n">myround</span>
<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="n">ShadowDecTree</span><span class="p">,</span> <span class="n">ShadowDecTreeNode</span>
<span class="kn">from</span> <span class="nn">dtreeviz.colors</span> <span class="k">import</span> <span class="n">adjust_colors</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">graphviz</span>

<span class="c1"># How many bins should we have based upon number of classes</span>
<span class="n">NUM_BINS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
          <span class="c1"># 0, 1, 2,  3, 4, 5, 6, 7, 8, 9, 10</span>

<span class="k">def</span> <span class="nf">rtreeviz_univar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">x_train</span><span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>  <span class="c1"># 1 vector of X data</span>
                    <span class="n">y_train</span><span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                    <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
                    <span class="n">show</span><span class="o">=</span><span class="p">{</span><span class="s1">'title'</span><span class="p">,</span><span class="s1">'splits'</span><span class="p">},</span>
                    <span class="n">split_linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">mean_linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">adjust_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

    <span class="n">y_range</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>  <span class="c1"># same y axis for all</span>
    <span class="n">overall_feature_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_train</span><span class="p">))</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="n">min_samples_leaf</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="n">shadow_tree</span> <span class="o">=</span> <span class="n">ShadowDecTree</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="n">feature_name</span><span class="p">])</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">shadow_tree</span><span class="o">.</span><span class="n">internal</span><span class="p">:</span>
        <span class="n">splits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">splits</span><span class="p">)</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">splits</span> <span class="o">+</span> <span class="p">[</span><span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">inrange</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[(</span><span class="n">x_train</span> <span class="o">&gt;=</span> <span class="n">left</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_train</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">)]</span>
        <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">inrange</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'scatter_marker'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span>
               <span class="n">edgecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'scatter_edge'</span><span class="p">],</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'splits'</span> <span class="ow">in</span> <span class="n">show</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">split</span><span class="p">,</span> <span class="n">split</span><span class="p">],</span> <span class="p">[</span><span class="o">*</span><span class="n">y_range</span><span class="p">],</span> <span class="s1">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'split_line'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">split_linewidth</span><span class="p">)</span>

        <span class="n">prevX</span> <span class="o">=</span> <span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">means</span><span class="p">):</span>
            <span class="n">split</span> <span class="o">=</span> <span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">prevX</span><span class="p">,</span> <span class="n">split</span><span class="p">],</span> <span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'mean_line'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">mean_linewidth</span><span class="p">)</span>
            <span class="n">prevX</span> <span class="o">=</span> <span class="n">split</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'major'</span><span class="p">,</span> <span class="n">width</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'tick_label'</span><span class="p">],</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'title'</span> <span class="ow">in</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"Regression tree depth </span><span class="si">{max_depth}</span><span class="s2">, samples per leaf </span><span class="si">{min_samples_leaf}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">Training $R^2$={t.score(x_train.reshape(-1,1),y_train):.3f}"</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'title'</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'axis_label'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s1">'axis_label'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-a-toy-sample">Create a toy sample<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-4/#Create-a-toy-sample">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">graphviz</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">91</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Sample Data for Univariate Regression'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualize-a-tree-using-rtreeviz_univar">Visualize a tree using <code>rtreeviz_univar</code><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-4/#Visualize-a-tree-using-rtreeviz_univar">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rtreeviz_univar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> 
                <span class="n">feature_name</span><span class="o">=</span><span class="s1">'X'</span><span class="p">,</span> 
                <span class="n">target_name</span><span class="o">=</span><span class="s1">'Y'</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYcAAAE1CAYAAAAMHCwAAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAgAElEQVR4nO2dfZxcVXn4vwuJTYQkSgJJIDVZXoIBaYIJNiChhJ4HEK0/CrVaLaBSkHcQEEREggryVgRKKKhtealUqrQVCpica6BEIGACBAmhQVmiEbJIAglJE0xwf3+cO2Eys7N79jI755y7z/fzmc/u3Hvnzvc8c2eee17uPW1dXV0oiqIoSjXbhBZQFEVR4kOTg6IoilKHJgdFURSlDk0OiqIoSh2aHBRFUZQ6NDkoiqIodQwKLaC8c0TMwcADwI7WZq8G1mk5IuZc4DRrswkteK9bgFHWZh/r7/cqGyLmReAGa7OrQ7s0g/46FkTMicBXgXHA163NZjVz/74MiOSQf4jH5U/fAl4C7gW+Ym32WiivJvIIMBZY1Z9vImJmAX9lbfaB/nyfGBAxE4AOYD9rs4VN2N91wIeBDwAru0tkImYf4AbgQ8Bq4GbgG9ZmejHSAEHEvBeYDZwN/Ah4o8F2JwJ/A+wLjADarc1ebKbLgEgOORlwDK7MewH/DLwHF+B+Q8QMAt7qzy+4tdnvgZX9tf++ImLelTspb7MNcCuwD3Bo7UoRMxywwEPAfsCewC3AeuDvW2ap1NHi43k87jfqv63NXu5hu3cDc4EfA9/uD5GBlBzetDar/ICuEDF3Ap+t3kDEjACuAo4EhgJPAOdUnzmKmM8Ds4BRwE+B+4HZ1mZt+fpZwF8BVwMXAROAESJmPfAl4AvAzsAvgSuszf61at9fA44HxgCvAXOtzY7N1x0EXIk783wLeA443trsme6alUTMUcAlwETgFeAm4LJKksqr+N8D/hiXINcC11mbXdVd8ETMZ4GL8/8rie5z1ma35M9PA/4cOAz4R+BcEbNXHs+DgA15vL5Y9TkgYj6Xx2VX4Nf5a6+zNvtDdx75a87DnVltD/wH8EI32/S439z5dOAjwEzgd8CFVZ9HR/735yIG4H+szQ6u2v+ZwHm4L+l/Aadam/1fI2drs9Pz151LN8kB+Ey+r+OszTYAz4iYScDZIuYa35MLEfPHuNrHDGBIXvZZ1mY/yNdfDvwl8D6gE/h34GvWZhvz9bNwx+9VuONnFPBD3HH7d8AFueetwLlV8XwRl8x2x31/1gFX99SE1Nv3LV9/A+6YGo6r8V9vbXZtg/1V3K8FvgbsCMwB/q66udXz2Kg7nhuVo2q/bfT+HW8Y//w79i/5pi/kx123NYJKDETMtN68ijIgO6RFzK7A4cCmqmVtuKamXYCP4aprDwHzRMzYfJv9cT+os4EpwN24L1At7cCngU8Ak4GNwDdxP/yn4mou3wJuFjEfzfd9NO4APAXYI3d4PF83CHeG8LN8f38KXIdLEt2VbyruC/0fuDPVL+O+1KfVbPpF4BfAB4ErgCvzMnbHnbgz2P/FNWGNzZdVuBi4L3+/2XnMHgKewTWTGNyP+d0iZpvc8wTgMtwXeRJwDnB+HoNuETF/jYvlxbn3/+ISRfU2vvu9BPcZTgG+A9xW9WX7UP738LysR1W9bgYuSRvgk7gv+5mNnD3ZH5ifJ4YKc3A/MhP6sJ8bcT/eM4G9gbOA16vWrwc+j4vLKcCngAtr9jEB+H+4Y/Bo3HH8Y1yN5lBckjgdV+5qzgaW4j6Xi4HL8pOUOny+b7jPeZ98/ftz79/2Uv4JwN/m/gb3Xfrnqvf1PTa2Op57ec8KPX7Hc3qK/5244w3c8TcW+I3nezedgVRzOFzErAO2xZ1RwdY/KjNxPxI7Vn1BLxIxf4FrjroSOAN3Nn9Fvn6ZiNkPOKHmvd4FHGNt1gkgYrbL3+tQa7P5+TYdIuZDuAPpXlx18uV8/5twZzSVGstwXBPYPdZmv8qXPddDWc/GneleXOW5B+5L8A9V2821Nrsh//8fRMwZuLOlR2t3aG22IY/f5uoz/yrutDb7XuWJiPk6sNja7PyqZcfi2tKn4RLfRcB51mY/qorJ5bgvzQ10z1nArdZmN+fPLxUxM3FnrBV89/sf3eznLNyPy+/y5au6Ke9a4GRrs83AUhHzQ1zcvtXA2YcxwIqaZZ1V6zrwYzxwl7XZ4vz5Vq+zNvtG1dMXRcxluJOSi6qWb4urFa7B1WB+AvwZsEvevLJUxDyM+87cVfW6x6zNLs3/r3w3zsadpNTi830bDzxpbfZ4xdej/EOBY63Nfg0gYr4AzBcxe1ibPY//sbHV8dwbnt/xHuOff8cq/Ya/a/A9axkDKTk8BJyIO3hOAHYDrq9aPxV3xvW7vDpXYUi+Lbizl3tq9vsY9clhRSUx5OyV7+cnVU0yAIN5+4D/Ie7ss0PEzAF+AtxtbfamtdnqvFN9joj5Ka555ofWZo3OKiaRH4xV/Ay4WMQMtzZbmy97umabl4CdGuyzN2o7bacCB+UJpZbdREwHrknrZhHzj1XrBgFtPbzPJFztrZpHyZODiNmxD/utTYKPAh+ld57NE0OFl3C1uXdKbdNRW4PlPXEdcJOIORx3nPyntdmiykoR81e4BLg7ria3bf6o5td5YqjQCSyraXfvpP5Y6S6e3dYc8Pu+/SPwIxHzQVx/zD3WZv/TYH8VfltJDDmPAX8AJomY1/E/Nvo6CMHnO+4b/ygYSM1K/2dt9ktrs19Ym52BOzCrz5a2wR3wU2oe76/arg2/L+r6mueVOP9Fzb73Jm9/zn/o98S1V67FNeEsys9IsDb7HO4H6CHg47gzs8MavH9PntXLN3Wzrugx0V2Z76U+nnsA/131PifVrP8ALi5F6a/9VtPMuFVYiashVFP58e3EE2uzf8I1a/4Lrr/pkbwtHhEzHfgBrrnqL3BNOV/F/YBV0135ml3mXr9v1mb342oPV+P6Pu4VMf/S7d783xP8jo3a49l33w2/432IfxQMpJpDLZcA94uY71ibvYTrDBsN/MHarK6DM2cpb7dFV6h93h3PAm8C463N5jXaKO8UvBf3Jbgc94PxYdyoBPKmgsXAFSLmftzw3DkN3u/AmmUH4mo03Q6N8+T3+J/lPAH8NbA8byar5Q0R81tgN2uz2/rgsBSYTlU7cv4cAGuzzj7st7v9LM3/r5wlt+qs7lHc5zqk0jkMCK5W8mJfdmRttgLXh/IdEXM+rkY6C3cs/ba6aUPEjH/n6luY3s3zpd1tiN/3jbwj+Xbg9vyY/zcRc5K12ZsNXrKLiPnjqlr1h3A/3Ev7eGz0FZ/veH/Hv6kM2ORgbfagiFmCy9yn4Ia6Pgz8OB8N8xzuTO5wIMvbEa8HfiZivoQboXIQ9Z1y3b3XGyLmauDqvCPuIVyVcjruy/GdfKTCIFw1eB2uo3MT8LyIacfVKO7GdcjtCvwJrtrdHX+PG2UzC7gD15F4DvAV3/g04EVgfF7N/zXwRg9f0tm45rY7RcwVuDb8XXEJ45w8Sc3C9XW8juv8G4zrzNzF2qxR+/11uI7jnwMP4kan/CmuL6OC736PqtnPn/N289AruBFWh+UjcTbWNLX0CRFTaUbYGXiXiJmSr3o2b665A9cJeouI+SburP/LwCV9GQYt7nqK+4FluL6qw3E/XOTLdhExn8Elo8No7lDu6SLmAtz4/IOBY3GjsLqj1+9b3m/1BLAE9904Cnihh2MO3Gd2q4g5G9eEfBNwb97fAMWOuV7x+Y7TxPiLmDG4eE3MF+0lYt6DaxJc3fiV/gykZqXuuAY4XsSMz7+ARwDzgO/iRsH8O66p5yUAa7NHcT94Z+Da64/EjfLZWL/rOi7CHZjn4g52ixsJUukwfB030mE+boTP0cBR1mYdwP/hDoIf4g6wW4Hv5+9dh7XZE7gRJkfn+7o8fzTq5PXlLtwX6qe4H/uGB3ZeG/swrr33J7gyz8adXb2Zb/M93MiNY3A1ovm4fqGGna/WZnfi4ngp8CRuNMk1Ndv47ncWLkZPAyfjOmF/nu9jM+5z/jvc5//jRk6efC/3/SJuFMqT+WPn/P3W4GoKO+Pau2fjkvyWsomYCSKmKz+RaMQ2uEEHz+KOsU7yC0Ctze7BDR29Ni+z4EbtNItrcCctT+JG7nytquN3K3y+b7jj5FLcZ/gwMAzXHNMTL+Kabu7J9/0C8Lmq9+3zMdcHevyONzn+J+Hi/P38+b35849XNhAxD4qYBwvunzadCe6dIWK+DRhrs31Cuyj+5J2Gn2j04xUj+Wiq+4C9e2qKCYFEcGsMGUBX8PsgYpYDNxWtEQ3YZqWi5E1KFtf0Y3AZ/J021yiKD0fgLqqKKjEo8SFi9sbVvApfXa/Joe9Mw1UbR+Cqixfg2sEVpV+xNvtSaAclDazNlvB2f0QhtFlJURRFqWOgd0griqIo3aDJQVEURalDk4OiKIpShyYHRVEUpQ4draQoARE3/8LtuPsobcJdEd3dXUwVpaVozUFRwrIZOMvabC/cFbPXiZh3B3ZSFB3KqqSLFJjgvchrWomIeRr4WM1tpxWl5WizktKv1NzbvjtutTb7bMHdn0nPcz806zWFEDHzcJPagKshvAhcaW323QbbT8PdCK7Q7F/ippI9FzdXws7k07h6vvYU3BSXY3H3BTqratIar2189qGkgzYrKf3N2KrHCd0sq5teU8S8y2fH1mZrrM1e733Ld/aad8C+uFurjMVN7vID3EQz+9ZuKGJGArfh5gUvWp3fHnejxTNxdyf1QsR8EneV/2W58yO429m/z3cbn30oaaE1B6VfqZ7qML9N8lbL8uUP4u77vx53B9EXgf3y2cwuxE3G0gX8HHc2ujR/3S1UNRHl+3kWd4fbE3F3hL0NNy3kH97Ba7bD3R79qNzxWtwdZ19tVOsRMbvhpnb9SaW8IuZm3C3i98bdQbOy7R8B/wl8y9rskd5i2ghrs/twN+arlNOXs4Fbqmo0p+exPxl3exifbXz2oSSEJgclFv4WN0HNDN5u9tmOt29vPBT3w3qPiNmrZsrKaj6DO4M9ADcT1x3AIuDfenjv3l7z97g5lP8Sdzvpi3LP/+xhn1NxM/o9DVvuv38VLvk8Udkov/f/LcA8a7Pba3ciYr5C7zd2/EjR5pu8ljYVN9taNXNx8eh1G599KOmhyUGJhQ5rs3OqF1ibVU9ej4j5HO4H90O4ObG741lrs8o98peJmBNwk/j0lBwavkbEbI+7//+x1mY29zgeWNFLeabimnnWiJhtcMnt97iJjp6t2u7DuImdnhYxR+bLjrE2+0X+/024eQ564re9rO+JUbjZ7mqnIu3E3XXYZxuffSiJoclBiYVFtQvypplv4GZn2xHXR7YN0FM79tM1z1/i7bmYi7xmN1wn8eOVldZm60XMM73scypugp+rcDOyXQb80trs2uqNrM1+Rg99f/msXk2Z2asXavs5upuHvLdtfPahJIImByUWupvQ/R7cWfEX8r+bcf0DPXVY185X3UXvAy96ek1b1bK+sC9wu7XZLwFEzBeADhFzc1WtoFf6u1kJeBV4CzflZDU78XZNoLdtfPahJIaOVlKiJB+9Mwm4zNosyzuhh9H6E5pf4pLHh6rc3o3rJO+WfM7vHYAtScDabDmuE/qYPr7/Tbh+kJ4eC/u4zy3kfTeLcBfgVSO4EUe9buOzDyU9tOagxMpruDPSE0TMb4BdcE00m1spYW22TsT8M3CFiHkVeBnXMb4NjWsTU3Edz0trd4ebU/i8Pry/d7NS3j+ye/50G+B9ImYKsLpyUZ2IOQ04zdrs/VUvvQa4XcQ8jpur+STcdRI39WEbn30oCaE1ByVK8mGkn8RNWP8MMBs3SujNADrn4iaivxt4ANdHsRDY2GD7qcCvrM1qrzWwwO75FI79wTRc7eRJXAf4Jfn/X6/aZhSw51ZSNrsTOAuX9J4CDgSOyGs7Xtv47ENJC719hqL0kfy6hOXAVdZmhefoVZSY0WYlRemF/IrmSbgRS8OA8/O/d4b0UpT+RJODovhxNq45ZjOu2eQga7PernVQlGTRZiVFURSlDu2QVhRFUerQ5KAoiqLUUZo+h1GjRnVNmDAhtIaiKEpSLFq06NWurq4da5eXJjlMmDCBhQsLXyiqKIoyIGlra+v2WhRtVlIURVHq0OSgKIqi1KHJQVEURalDk4OiKIpShyYHRVEUpQ5NDoqiKEodpRnKqiiKMtBYvqKTVWvWMXLE9owfN7qp+9bkoCiKEiHrzzC9bjMqf2SfuBGgqQlCm5VKypIlS0IrFMbXPZUypuIJGvtWsHxFJ08s+RXLVzRveu1Bg4ewas26pu0PtOZQWhYtWsjee/fXhGP9i697KmVMxRM09v3N8hWdPNWxhkGDh/Cb1WuAxmf7212fcdttt3Lsscf1uq/NmzYycsSIprpqcigp06fvH1qhML7uqZQxFU/Q2Pc3q9asY9DgIcDbZ/s9NQX15F95netzGKF9Doofy5YtY+LEiaE1CuHrnkoZU/GEcsV+/RmGXYD1oUWq2JOaCbzp2W8XgOuzhuvHjxvd9KRQQfscSsrq1atCKxTG1z2VMqbiCeWLvVKc0swEN23atC69K+vbvPrqq4waNSq0RiF83VMpYyqeoLHvb55Y8itefmPwludjh23ig3vv1nD7Vvi3tbUt6urqmla7XGsOJeW+++4NrVAYX/dUypiKJ2js+5uRI7Zn86aNAHkn8vY9bh/SX/scSsq4ceNCKxTG1z2VMqbiCRr7/qavncgh/TU5lJSRI0eGViiMr3sqZUzFEzT2raAvncgh/bVZqaQsXrw4tEJhfN1TKWMqnqCxj42Q/pocSsqMGTNCKxTG1z2VMqbiCRr72Ajpr8mhpKR8xqRnr+HQ2MeF1hyUprN27drQCoXxdU+ljKl4gsY+NkL663UOJSW28d19Qcfah0NjHxd6nYPSdGIb390XdKx9ODT2cRHSX5NDSWlvbw+tUBhf91TKmIonaOxjI6S/JoeSMmTI0NAKhfF1T6WMqXiCxj42QvprcigpS5c+G1qhML7uqZQxFU/Q2MdGSH9NDiVl5sxDQisUxtc9lTKm4gka+9gI6a/JoaQsWLAgtEJhfN1TKWMqnqCxj42Q/i27t5KI2RaYBfwtMBZ4Gfg+MMvabHO+TRtwMXAi8F7gMeBUa7P4JoKNnE2bNoVWKIyveyplTMUTNPaxEdK/lTWH84FTgTOA9wNn5s8vqNrmPOAc4HRgP+AVwIqYYS30LAWHHJJuddrXPZUypuIJGvvYCOnfyuRwAHCPtdk91mYvWpvdDdwN/ClsqTWcBVxubXaXtdkzwHHAMODTLfQsBXPnzgmtUBhf91TKmIonaOxjI6R/K5PDz4CZIub9ACJmL+AQ4L58fTswBphbeYG12QbgIVxiqaOtrW1i5dGf4imyxx7phsTXPZUypuIJGvvYCOnfyvkcrsDVAp4VMW/l732ptdmN+fox+d/Omtd1ks+zrSiKorSGVtYcPgkci2si+mD+/yki5via7Wpv9tTWzTK3YVfXssqj2bKp8/zz6YbE1z2VMqbiCRr72Ajp38qaw1XA1dZmP8if/0LEjMd1SP8TsDJfPgb4TdXrdqK+NqH0wqGHHhZaoTC+7qmUMRVP0NjHRkj/VtYc3g28VbPsrSqHDlyCkMpKETMEmAE80grBMjFv3rzQCoXxdU+ljKl4gsY+NkL6t7LmcA/wZRHTASwB9gXOBm4DsDbrEjHXAheKmOeAZcBXgXXAHS30LAWDBw8OrVAYX/dUypiKJ2jsYyOkfyuTw+nAN4AbcU1FLwPfBb5etc2VwFBgNm9fBHeotdkbLfQsBdOnTw+tUBhf91TKmIonaOxjI6h/V1dXKR5Tp07tUt7m1ltvCa1QGF/3VMqYimdXl8Y+NlrhDyzs6uY3Ve+tVFImTdortEJhfN1TKWMqnqCxj42Q/pocSsrGjRtCKxTG1z2VMqbiCRr72Ajpr8mhpHR0dIRWKIyveyplTMUTNPaxEdK/zTU5pc+0adO6Fi5cGFojGlKeWF0nuQ+Hxj4uWuHf1ta2qKura1rtcq05lJSUJ1bXSe7DobGPi5D+mhxKyvDhw0MrFMbXPZUypuIJGvvYCOmvyaGkTJ48ObRCYXzdUyljKp6gsY+NkP6aHErK/PnzQysUxtc9lTKm4gka+9gI6a/JoaSkfMakZ6/h0NjHhdYclKazatWq0AqF8XVPpYypeILGPjZC+mtyKCkrVqwIrVAYX/dUypiKJ2jsYyOkv17nUFJSHt+tY+3DobGPC73OQWk6KY/v1rH24dDYx4Ve56A0nR12GBlaoTC+7qmUMRVP0NjHRkh/TQ4lZeLEiaEVCuPrnkoZU/EEjX1shPTX5FBSFix4NLRCYXzdUyljKp6gsY+NkP6aHErK1Kl1/UvJ4OueShlT8QSNfWyE9NfkUFJSHsKnwynDobGPi5D+mhxKSmfnytAKhfF1T6WMqXiCxj42QvrrdQ4lJeXx3TrWPhwa+7jQ6xyUppPy+G4dax8OjX1c6HUOStMZPXpMaIXC+LqnUsZUPEFjHxsh/TU5lJRx48aFViiMr3sqZUzFEzT2sRHSX5NDSVm0KN3+F1/3VMqYiido7GMjpL8mh5Iyffr+oRUK4+ueShlT8QSNfWyE9NfkUFKWLVsWWqEwvu6plDEVT9DYx0ZIf00OJWX16nQnOfF1T6WMqXiCxj42QvrrdQ4lJeXx3TrWPhwa+7jQ6xyUppPy+G4dax8OjX1c6HUOStNJeQifDqcMh8Y+LnQoq9J0Ro5Md5ITX/dUypiKJ2jsYyOkvyaHkrJ48eLQCoXxdU+ljKl4gsY+NkL6a3IoKTNmzAitUBhf91TKmIonaOxjI6T/oFa+mYgZC1wOHAEMA14ATrY2+598fRtwMXAi8F7gMeBUa7MlrfQsA4sXL6a9fdfQGoXwdU+ljKl4gsY+NkL6t6zmIGLeAzwMtAEfBSYBpwOvVG12HnBOvny/fJ0VMcNa5VkW1q5dG1qhML7uqZQxFU/Q2MdGSP+WXecgYi4D/sza7MMN1rcBLwE3WJtdmi8biksQ51qb3dzT/vU6h61JeXy3jrUPh8Y+LgbKdQ5HAo+JmDtFzCsi5ikRc1qeFADagTHA3MoLrM02AA8BB3S3w7a2tomVR3/Lp0bK47t1rH04NPZxMVCuc9gVOAXXz3AYcB2u/+HUfH3lxuWdNa/rrFqneNLe3h5aoTC+7qmUMRVP0NjHRkj/VnZIbwMstDa7IH/+pIjZA5ccbqjarradq62bZW7Drq4td6WaNq2uVjSgGTJkaGiFwvi6p1LGVDxBYx8bIf1bWXN4GXi2ZtlS4H35/5WZtGtrCTtRX5tQemHp0tpQp4OveyplTMUTNPaxEdK/lcnhYWDPmmUTgeX5/x24BCGVlSJmCDADeKQVgmVi5sxDQisUxtc9lTKm4gka+9gI6d/K5PBtYLqIuVDE7C5iPgGcAcwGsDbrAq4FvixijhIxHwBuAdYBd7TQsxQsWLAgtEJhfN1TKWMqnqCxj42Q/i1LDtZmP8eNWPpr4BngUuAi4Maqza4ErsEljIXAWOBQa7M3WuVZFjZt2hRaoTC+7qmUMRVP0NjHRkh/nc+hpKxcuZIxY9Ic5OXrnkoZU/EEjX1stMI/husclBYyd+6c0AqF8XVPpYypeILGPjZC+mtyKCl77JHudYG+7qmUMRVP0NjHRkh/TQ6KoihKHZocSsrzzy/rfaNI8XVPpYypeILGPjZC+muHdElJuSNOO0XDobGPC+2QVprOvHnzQisUxtc9lTKm4gka+9gI6a/JoaQMHjw4tEJhfN1TKWMqnqCxj42Q/pocSsr06dNDKxTG1z2VMqbiCRr72Ajpr8mhpDzwQLrVaV/3VMqYiido7GMjpL8mh5IyadJeoRUK4+ueShlT8QSNfWyE9NfkUFI2btwQWqEwvu6plDEVT9DYx0ZIf00OJaWjoyO0QmF83VMpYyqeoLGPjZD+ep1DSUlhYvXlKzpZtWYdI0dsz/hxo7csLzLJfaN9xUAKn0WFIrGPmVQ8G9EK/0bXObRymlClRaw/wzAUWB9apBdG5Q/Y2nUowPVZj6+tLWOjfcWAT3li4b777uXYY49r2nahScWzESH9NTko0RNzraBsDB8+vKnbhSYVz0aE9NfkUEK2uz6jo+MF2tt3Da3SkOUrOnmqYw2DBg9h86aNTGkfwfhxo1l/hgHY8hd6rhVsd33WcF+x0NHxAu2hJTyZPHlyU7cLTSqejQjprx3SJWX+/PmhFXpk/LjRTGkfwdhhm97xj3kz99UfxP5ZVOPrmkqZUvFsREh/rTmUlBTOmMaPG133Q77d9RmLFz/F5MlTgMY1DMBt18O+YiGFz6KC1hziIqS/JoeSsmrVqtAKhal2r/zguz6HrWsFqZQxFU/wd02lTKl4NiKkvyaHkrJixYrQCoWpdW9UK0iljKl4gr9rKmVKxbMRIf31OoeSkvL4bh1rHw6NfVyEvM6hxw5pEZP2LQ0HMPfdd29ohcL4uqdSxlQ8QWMfGyH9exut9JCI+YaI0eanxNhhh5GhFQrj655KGVPxBI19bIT07y05fAQ4BnhcxKR9e8MBxsSJE0MrFMbXPZUypuIJGvvYCOnfY3KwNvspsA/wJLBQxJzdEivlHbNgwaOhFQrj655KGVPxBI19bIT077W5yNrsDeB4EXMfcKeI+Trwh5pt0r5GvYRMnVrXv5QMvu6plDEVT9DYx0ZIf68rpEXMNOCbwPPAmcDpNQ8lMlIewqfDKcOhsY+LkP491hzyjuiLgfOBG4EvW5ttbIWY8s7o7FwZWqEwvu6plDEVT9DYx0ZI/x6vcxAxTwI7AJ/P+x+iRa9z2JqUx3frWPtwaOzjItrrHIBngD+JPTEo9aQ8vlvH2odDYx8XIf17bFayNjumVSJKcxk9ekxohcL4uqdSxlQ8QWMfGyH99ZbdJWXcuHGhFQrj655KGVPxBI19bIT0D5YcRMxXREyXiLmhalmbiJklYl4SMRtEzIMiZu9QjimzaFG6/S++7qmUMRVP0NjHRkj/IMkhv2fTCcDTNavOA87BDY/dD7i4tNYAABEVSURBVHgFsCJmWGsN02f69P1DKxTG1z2VMqbiCRr72Ajp3/LkIGJGAN8Hjgdeq1reBpwFXG5tdpe12TPAccAw4NOt9kydZcuWhVYojK97KmVMxRM09rER0j9EzeE7wI+szebVLG8HxgBzKwuszTYADwEHdLejtra2iZVHf8mmyurV6U5y4uueShlT8QSNfWyE9G/p3VZFzAnA7rib+dVS6ZbvrFneCezSn15l5IgjPhpaoTC+7qmUMRVP0NjHRkj/ltUcRMyewGXAZ6zNft/DprVX5bV1s8xt2NW1rPJokmZpSHl8t461D4fGPi6ivc6hyewPjAKeETGVZdsCB4mYk4DKqKQxwG+qXrcT9bUJpRdSHsKnwynDobGPi4EylPW/cLf/nlL1WAj8IP9/GbASkMoLRMwQYAbwSAs9S8HIkelOcuLrnkoZU/EEjX1shPRvWXKwNnvd2uyZ6gewHlidP+8CrgW+LGKOEjEfAG4B1gF3tMqzLCxevDi0QmF83VMpYyqeoLGPjZD+sU3/eSUwFJgNvBd4DDg0n1NC6QMzZswIrVAYX/dUypiKJ2jsYyOkf9DkYG12cM3zLmBW/lDeAYsXL6a9fdfQGoXwdU+ljKl4gsY+NkL6672VSsratWtDKxTG1z2VMqbiCRr72Ajp3+N8Dimh8zlsTcr3sdc5BcKhsY+LmOdzUBIl5fHdOtY+HBr7uAjpr8mhpLS3t4dWKIyveyplTMUTNPaxEdJfk0NJGTJkaGiFwvi6p1LGVDxBYx8bIf01OZSUpUufDa1QGF/3VMqYiido7GMjpL8mh5Iyc+YhoRUK4+ueShlT8QSNfWyE9NfkUFIWLFgQWqEwvu6plDEVT9DYx0ZIf00OJWXTpk2hFQrj655KGVPxBI19bIT01+scSsrKlSsZM2ZM7xtGiK97KmVMxRM09rHRCn+9zmGAMXfunNAKhfF1T6WMqXiCxj42Qvprcigpe+yR7sypvu6plDEVT9DYx0ZIf00OiqIoSh2aHErK88+nO3Oqr3sqZUzFEzT2sRHSXzukS0rKHXHaKRoOjX1caIe00nTmzZsXWqEwvu6plDEVT9DYx0ZIf00OJWXw4MGhFQrj655KGVPxBI19bIT01+RQUqZPnx5aoTC+7qmUMRVP0NjHRkh/TQ4l5YEH0q1O+7qnUsZUPEFjHxsh/TU5lJRJk/YKrVAYX/dUypiKJ2jsYyOkvyaHkrJx44bQCoXxdU+ljKl4gsY+NkL6a3IoKR0dHaEVCuPrnkoZU/EEjX1shPTX6xxKSsoTq+sk9+HQ2MdFK/z1OocBRsoTq+sk9+HQ2MdFSH9NDiVl+PDhoRUK4+ueShlT8QSNfWyE9NfkUFImT54cWqEwvu6plDEVT9DYx0ZIf00OJWX+/PmhFQrj655KGVPxBI19bIT01+RQUlI+Y9Kz13Bo7ONCaw5K01m1alVohcL4uqdSxlQ8QWMfGyH9NTmUlBUrVoRWKIyveyplTMUTNPaxEdJfr3MoKSmP79ax9uHQ2MeFXuegNJ2Ux3frWPtwaOzjIqT/oGDvrPQrO+wwMrRCYXzdUyljKp5Q77p8RSer1qxj5IjtGT9udMPtYiUVz0aE9G9ZchAxFwBHAXsCbwILgAuszZ6p2qYNuBg4EXgv8BhwqrXZklZ5loWJEyeGViiMr3sqZUzFc/0ZhpnA+rnXblk2Kn8ArK/adibAxz7WMreipBL7RoT0b2Wz0sHAjcABwCHAZiATMTtUbXMecA5wOrAf8ApgRcywFnqWggULHg2tUBhf91TKGKPn8hWdPLHkVyxf0RlapV+JMfZ9IaR/y2oO1maHVT8XMccAa4APA/fktYazgMutze7KtzkOlyA+Ddxcu8+2trYtaXXq1Kn9J58gU6fW9S8lg697CmVcf4bhaGD9wttDq2xFoxoBwHbXZ4BLIE91rGHQ4CFs3rSRKe0jtjQtLVmyhL1bZlucFI6RngjpH7JDelj+/q/lz9uBMcDcygbWZhuAh3C1DaUPpDyEr2zDKVNl/LjRTGkfwdhhm7ZKDJBO7FPxbERI/5Ad0tcBTwGVetOY/G9tPbcT2KW7HXR1dS2r/D9tWtpnCM2ms3NlaIXC+LqnUMbtrs+47bZbOfbY40KrbKGnGsFtt93KsVXbjh83equkUKE69o06rWMghWOkJ0L6B0kOIuYa4EDgQGuzt2pW11540dbNMqUXjjjio6EVCuPrnkoZY/Os/IC7H/StawQ+rrVNZT01UYXmaICIEnNfCXnstLxZScR8G/gb4BBrsxeqVlVS5Jial+xEfW1C6YWUx3frWPv+Z/y40Xxw793qzvRjdB3IDJjrHETMdcCngIOtzZ6rWd2BSxAC/DzffggwA/hSKz3LwOjRtTk2HXzdUyljKp7g57rd9Rlz5szhsMMO67GJKgbmzJnDYb1vFi0hj51WXucwGzgGOBJ4TcRUSr3O2mydtVmXiLkWuFDEPAcsA74KrAPuaJVnWRg3blxohcL4uqdSxlQ8oe+x76mJKgZSin13hPRvZbPSKbgRSj8FXq56nFu1zZXANcBsYCEwFjjU2uyNFnqWgkWL0r3PlK97KmVMxROKxb5RE1UMpBT77gjp38rrHNo8tukCZuUP5R0wffr+oRUK4+ueShlT8QSNfWyE9Ncb75WUZcuW9b5RpPi6p1LGVDxBYx8bIf01OZSU1avTneTE1z2VMqbiCRr72Ajpr/M5lJSU72OvcwqEQ2MfFzqfg9J0Uh6vrtc5hENjHxch/TU5lJSUh/DpUNZwaOzjYqAMZVVayMiR6U5y4uueShlT8QSNfWyE9NfkUFIWL14cWqEwvu6plDEVT9DYx0ZIf00OJWXGjBmhFQrj655KGVPxBI19bIT01+RQUlI+Y9Kz13Bo7ONCaw5K01m7dm1ohcL4uqdSxlQ8QWMfGyH99TqHkpLy+G4dax8OjX1c6HUOStNJeXy3jrUPh8Y+LvQ6B6XptLe3h1YojK97KmVMxRM09rER0l+TQ0kZMmRoaIXC+LqnUsZUPEFjHxsh/TU5lJSlS58NrVAYX/dUypiKJ2jsYyOkvyaHkjJz5iGhFQrj655KGVPxBI19bIT01+RQUhYsWBBaoTC+7qmUMRVP0NjHRkh/TQ4lZdOmTaEVCuPrnkoZU/EEjX1shPTX6xxKysqVKxkzZkxojUL4uqdSxlQ8QWMfG63w1+scBhhz584JrVAYX/dUypiKJ2jsYyOkvyaHkrLHHhNDKxTG1z2VMqbiCRr72Ajpr8lBURRFqUOTQ0l5/vlloRUK4+ueShlT8QSNfWyE9NcO6ZKSckecdoqGQ2MfF9ohrTSdefPmhVYojK97KmVMxRM09rER0l+TQ0kZPHhwaIXC+LqnUsZUPEFjHxsh/TU5lJTp06eHViiMr3sqZUzFEzT2sRHSX5NDSXnggXSr077uqZQxFU/Q2MdGSH9NDiVl0qS9QisUxtc9lTKm4gka+9gI6a/JoaRs3LghtEJhfN1TKWMqnqCxj42Q/pocSkpHR0dohcL4uqdSxlQ8QWMfGyH99TqHkpLyxOo6yX04NPZx0Qr/pK5zEDGniJgOEbNRxCwSMTNCO6VGyhOr6yT34dDYx0VI/+iSg4j5JHAdcBmwL/AIcL+IeV9QscQYPnx4aIXC+LqnUsZUPEFjHxsh/QcFe+fGnA3cYm323fz56SLmcOBk4IJmv9nyFZ2sWrOOkSO2Z/y40X1aFjOTJ08OrVAYX/dUypiKJ2jsYyOkf1TJQcS8C5gKXF2zai5wQO32bW1tW+5nO3Xq1D6/3/IVnYy68jNUWvTW539H5Y/elsXMTgDXZ6E1CjF//nza23dt2nahScUTNPaxEdI/tmalUcC2QGfN8k6g6XefWrVmXbN3qTQBPXsNh8Y+LrTmUE/tEKq2bpbR1dW15X6206bVdbb3ysgR25N94kYGDR7C5k0bmdI+AoCnOtb0uiyFpqVUmTx5SlO3C00qnqCxj42Q/rElh1eBt6ivJexEfW3iHVP5gXd9CVv/4PsuUxRFKSNRJQdrs9+LmEWAAD+sWiXAXf3xnuPHja77sfddpiiKUlaiSg451wC3i5jHgYeBk4CdgZuCWimKogwgYuuQxtrsTuAs4KvAU8CBwBHWZsuDiimKogwgYqw5YG12I3BjaA9FUZSBSnQ1B0VRFCU8mhwURVGUOjQ5KIqiKHWU5pbdbW1tvwOKdFr/Uf73zSbqKH5o7MOhsQ9HbLEf39XVtWPtwtIkh6JU7s9UfbW10ho09uHQ2Icjldhrs5KiKIpShyYHRVEUpY4B36ykKIqi1KM1B0VRFKUOTQ6KoihKHZocFEVRlDqivLdSKxExpwBfAsYCS4CzrM3mh7UqFyLmIOBc3BSwOwOfsza7pWp9G3AxcCLwXuAx4FRrsyWtty0XIuYC4ChgT9y4+gXABdZmz1Rto/HvB0TMqcAXgAn5oiXAN63N7s3XRx33AV1zEDGfBK4DLgP2BR4B7hcx7wsqVj62B54BzgQ2dLP+POAc4HRgP+AVwIqYYS0zLC8H425ieQBwCLAZyETMDlXbaPz7hxXA+cAHgWnAPOC/RMyf5OujjvuAHq0kYh4DnrY2O6Fq2fPAj6zNLghnVl5EzDrgtErNIT97egm4wdrs0nzZUNwX5Vxrs5tDuZYREbM9sAY40trsHo1/axExq4ELgO8QedwHbM1BxLwL18wxt2bVXNxZltIa2nHTwm75HKzNNgAPoZ9DfzAM971/LX+u8W8BImZbEfMpXC36ERKI+4BNDsAoYFvq56bupH4Oa6X/qMRaP4fWcB1uEq1H8+ca/35ExOyT15bfxM1m+ZfWZr8ggbgP+A5poLZdra2bZUr/o59DPyNirsHNrHigtdlbNas1/v3D/wJTgPcARwO3ipiDq9ZHG/eBnBxeBd6iPkvvRH02V/qPlfnfMcBvqpbr59BERMy3gU8BM63NXqhapfHvR6zNfg/8Mn+6UMTsB3wRuDRfFm3cB2yzUv6hLQKkZpXg2gSV1tCB+4Ha8jmImCHADPRzaAoi5jrg08Ah1mbP1azW+LeWbXC37I4+7gO55gBwDXC7iHkceBg4CTcO/6agViUjHyGze/50G+B9ImYKsNra7Nci5lrgQhHzHLAM+CqwDrgjiHCJEDGzgWOAI4HXREylprzO2mydtVmXxr9/EDGXA/fiagbDcAn6YOCjKcR9QCcHa7M7RcxI3IcyFjcW/whrsyKTBimNmQY8UPX8kvxxK/BZ4EpgKDCbty8GOtTa7I3WapaSU/K/P61ZfgkwK/9f498/jAH+Nf+7Bnga+Ii12Zx8fdRxH9DXOSiKoijdM2D7HBRFUZTGaHJQFEVR6tDkoCiKotShyUFRFEWpQ5ODoiiKUocmB0VRFKUOTQ6KoihKHQP6IjhF6Q9EzDbAg8Dr1mYfr1r+buBJYJ612cmB9BTFC605KEqTsTb7A+7K70NEzOerVl2BOyE7N4SXovQFvUJaUfoJEXMS7hYJ++DuLTUHONja7GdBxRTFA00OitKPiJg5uPvnTAB+YG12XlgjRfFDm5UUpX85CTfBzpvARYFdFMUbTQ6K0r98HtgAjAN2DeyiKN5os5Ki9BP5rF+PAB8HTgZGAwd0M0WnokSH1hwUpR/IZ/W6DbjF2ux+4ERcp7T2OShJoMlBUfqHbwFDgLMBrM1WAqcCs0TMB0KKKYoP2qykKE1GxBwEzAOMtdmDNev+Hdf3MN3abHMAPUXxQpODoiiKUoc2KymKoih1aHJQFEVR6tDkoCiKotShyUFRFEWpQ5ODoiiKUocmB0VRFKUOTQ6KoihKHZocFEVRlDo0OSiKoih1/H9SIxZ9fqk1UgAAAABJRU5ErkJggg==">
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/split-up-dtreeviz-part-3/" class="u-url">Split Up: dtreeviz (Part 3)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/split-up-dtreeviz-part-3/" rel="bookmark">
            <time class="published dt-published" datetime="2019-07-18T08:17:01-07:00" itemprop="datePublished" title="Jul 18, 2019, 8:17:01 AM">Jul 18, 2019, 8:17:01 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/split-up-dtreeviz-part-3/#disqus_thread" data-disqus-identifier="cache/posts/split-up-dtreeviz-part-3.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Goal">¶</a>
</h2>
<p>This post aims to break down the module <a href="https://github.com/parrt/dtreeviz"><code>dtreeviz</code></a> module step by step to fully understand what is implemented. After fully understanding this, I would like to contribute to this module and submit a pull request.</p>
<p>I really like this module and would like to see this works for other tree-based modules like XGBoost or Lightgbm. I found <a href="https://github.com/parrt/dtreeviz/issues/15">the exact same issue (issues 15)</a> in github so I hope I could contribute to this issue.</p>
<p>This post is the 3rd part: breaking down <code>ShadowDecTree</code>.</p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://github.com/parrt/dtreeviz">Github dtreeviz</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-1/">Step by Step Data Science - Split-Up: dtreeviz (Part 1)</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-2/">Step by Step Data Science - Split-Up: dtreeviz (Part 2)</a></li>
<li><a href="https://scikit-learn.org/stable/modules/tree.html">Scikit-Learn - Tree</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ShadowDecTreeNode-class">
<code>ShadowDecTreeNode</code> class<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#ShadowDecTreeNode-class">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Source-github">Source <a href="https://github.com/parrt/dtreeviz/blob/master/dtreeviz/shadow.py">github</a><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Source-github">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="k">import</span> <span class="n">compute_class_weight</span>

<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="n">ShadowDecTree</span> 
<span class="c1"># skip ShadowDecTree Class</span>
<span class="c1">#</span>

<span class="k">class</span> <span class="nc">ShadowDecTreeNode</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    A node in a shadow tree.  Each node has left and right</span>
<span class="sd">    pointers to child nodes, if any.  As part of tree construction process, the</span>
<span class="sd">    samples examined at each decision node or at each leaf node are</span>
<span class="sd">    saved into field node_samples.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shadow_tree</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span> <span class="o">=</span> <span class="n">shadow_tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">threshold</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">feature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">feature</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">feature_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">feature_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">feature_names</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">()]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">samples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">"""</span>
<span class="sd">        Return a list of sample indexes associated with this node. If this is a</span>
<span class="sd">        leaf node, it indicates the samples used to compute the predicted value</span>
<span class="sd">        or class.  If this is an internal node, it is the number of samples used</span>
<span class="sd">        to compute the split point.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">node_to_samples</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">nsamples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Return the number of samples associated with this node. If this is a</span>
<span class="sd">        leaf node, it indicates the samples used to compute the predicted value</span>
<span class="sd">        or class. If this is an internal node, it is the number of samples used</span>
<span class="sd">        to compute the split point.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_node_samples</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="c1"># same as len(self.node_samples)</span>

    <span class="k">def</span> <span class="nf">split_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="sd">"""</span>
<span class="sd">        Return the list of indexes to the left and the right of the split value.</span>
<span class="sd">        """</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">())</span>
        <span class="n">node_X_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">X_train</span><span class="p">[</span><span class="n">samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">()]</span>
        <span class="n">split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">node_X_data</span> <span class="o">&lt;</span> <span class="n">split</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">node_X_data</span> <span class="o">&gt;=</span> <span class="n">split</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>

    <span class="k">def</span> <span class="nf">isleaf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">isclassifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">&gt;</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If this is a leaf node, return the predicted continuous value, if this is a</span>
<span class="sd">        regressor, or the class number, if this is a classifier.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isleaf</span><span class="p">():</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">():</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">predicted_class</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">prediction_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If the tree model is a classifier and we know the class names,</span>
<span class="sd">        return the class name associated with the prediction for this leaf node.</span>
<span class="sd">        Return prediction class or value otherwise.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">class_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">class_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prediction</span><span class="p">()]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">class_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        If this tree model is a classifier, return a list with the count</span>
<span class="sd">        associated with each class.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">class_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow_tree</span><span class="o">.</span><span class="n">class_weights</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"&lt;pred=</span><span class="si">{value}</span><span class="s2">,n=</span><span class="si">{n}</span><span class="s2">&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prediction</span><span class="p">(),</span><span class="mi">1</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nsamples</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"(</span><span class="si">{f}</span><span class="s2">@</span><span class="si">{s}</span><span class="s2"> </span><span class="si">{left}</span><span class="s2"> </span><span class="si">{right}</span><span class="s2">)"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">(),</span>
                                                     <span class="n">s</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="mi">1</span><span class="p">),</span>
                                                     <span class="n">left</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">''</span><span class="p">,</span>
                                                     <span class="n">right</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Instantiate-class-objects">Instantiate class objects<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Instantiate-class-objects">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-a-tree-model-by-scikit-learn">Create a tree model by scikit learn<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Create-a-tree-model-by-scikit-learn">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">graphviz</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># Y = [0, 1]</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                     <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  
                     <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'0'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">],</span>  
                     <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  
                     <span class="n">special_characters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>  
<span class="n">graph</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>



<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: Tree Pages: 1 --><svg width="220pt" height="211pt" viewbox="0.00 0.00 219.54 211.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 207.2)"><title>Tree</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-207.2 215.5378,-207.2 215.5378,4 -4,4"></polygon><!-- 0 --><g id="node1" class="node"><title>0</title>
<path fill="transparent" stroke="#000000" d="M141.3078,-203.2C141.3078,-203.2 69.23,-203.2 69.23,-203.2 63.23,-203.2 57.23,-197.2 57.23,-191.2 57.23,-191.2 57.23,-123.2 57.23,-123.2 57.23,-117.2 63.23,-111.2 69.23,-111.2 69.23,-111.2 141.3078,-111.2 141.3078,-111.2 147.3078,-111.2 153.3078,-117.2 153.3078,-123.2 153.3078,-123.2 153.3078,-191.2 153.3078,-191.2 153.3078,-197.2 147.3078,-203.2 141.3078,-203.2"></path><text text-anchor="start" x="82.7002" y="-186.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 ≤ 0.5</text><text text-anchor="start" x="76.6739" y="-169.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.5</text><text text-anchor="start" x="67.3422" y="-153" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 2</text><text text-anchor="start" x="65" y="-136.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [1, 1]</text><text text-anchor="start" x="77.4551" y="-119.4" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 0</text></g><!-- 1 --><g id="node2" class="node"><title>1</title>
<path fill="#e58139" stroke="#000000" d="M84.3078,-75.3003C84.3078,-75.3003 12.23,-75.3003 12.23,-75.3003 6.23,-75.3003 .23,-69.3003 .23,-63.3003 .23,-63.3003 .23,-11.8997 .23,-11.8997 .23,-5.8997 6.23,.1003 12.23,.1003 12.23,.1003 84.3078,.1003 84.3078,.1003 90.3078,.1003 96.3078,-5.8997 96.3078,-11.8997 96.3078,-11.8997 96.3078,-63.3003 96.3078,-63.3003 96.3078,-69.3003 90.3078,-75.3003 84.3078,-75.3003"></path><text text-anchor="start" x="19.6739" y="-58.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.0</text><text text-anchor="start" x="10.3422" y="-41.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 1</text><text text-anchor="start" x="8" y="-25" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [1, 0]</text><text text-anchor="start" x="20.4551" y="-8.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 0</text></g><!-- 0&#45;&gt;1 --><g id="edge1" class="edge"><title>0-&gt;1</title>
<path fill="none" stroke="#000000" d="M83.2312,-110.9595C79.0901,-102.2704 74.7568,-93.1781 70.6066,-84.47"></path><polygon fill="#000000" stroke="#000000" points="73.6547,-82.7302 66.1928,-75.2088 67.3356,-85.7419 73.6547,-82.7302"></polygon><text text-anchor="middle" x="57.8402" y="-94.5722" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">True</text></g><!-- 2 --><g id="node3" class="node"><title>2</title>
<path fill="#399de5" stroke="#000000" d="M199.3078,-75.3003C199.3078,-75.3003 127.23,-75.3003 127.23,-75.3003 121.23,-75.3003 115.23,-69.3003 115.23,-63.3003 115.23,-63.3003 115.23,-11.8997 115.23,-11.8997 115.23,-5.8997 121.23,.1003 127.23,.1003 127.23,.1003 199.3078,.1003 199.3078,.1003 205.3078,.1003 211.3078,-5.8997 211.3078,-11.8997 211.3078,-11.8997 211.3078,-63.3003 211.3078,-63.3003 211.3078,-69.3003 205.3078,-75.3003 199.3078,-75.3003"></path><text text-anchor="start" x="134.6739" y="-58.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.0</text><text text-anchor="start" x="125.3422" y="-41.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 1</text><text text-anchor="start" x="123" y="-25" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [0, 1]</text><text text-anchor="start" x="135.4551" y="-8.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 1</text></g><!-- 0&#45;&gt;2 --><g id="edge2" class="edge"><title>0-&gt;2</title>
<path fill="none" stroke="#000000" d="M127.6932,-110.9595C131.907,-102.2704 136.3163,-93.1781 140.5393,-84.47"></path><polygon fill="#000000" stroke="#000000" points="143.8162,-85.7339 145.0305,-75.2088 137.5178,-82.6794 143.8162,-85.7339"></polygon><text text-anchor="middle" x="153.2229" y="-94.6284" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">False</text></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-a-ShadowDecTreeNode">Create a <code>ShadowDecTreeNode</code><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Create-a-ShadowDecTreeNode">¶</a>
</h3>
<p><strong>ShadowDecTreeNode</strong> <code>__init__</code></p>
<ul>
<li>L222-226: store input arguments as class members</li>
<li>L228-308: define the same functions in tree objects like <code>split</code>, <code>feature</code> etc. or utility functions</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instantiate ShadowDecTree</span>
<span class="n">shadow_tree</span> <span class="o">=</span> <span class="n">ShadowDecTree</span><span class="p">(</span><span class="n">tree_model</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y_train</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instantiate ShadowDecTreeNode</span>
<span class="n">shadow_tree_node0</span> <span class="o">=</span> <span class="n">ShadowDecTreeNode</span><span class="p">(</span><span class="n">shadow_tree</span><span class="o">=</span><span class="n">shadow_tree</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">shadow_tree_node0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.ShadowDecTreeNode at 0x120eda908&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Methods-under-``ShadowTreeDecNode">Methods under ``ShadowTreeDecNode<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-3/#Methods-under-%60%60ShadowTreeDecNode">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L228 split</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L231 feature</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">feature</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L239 samples</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">samples</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[0, 1]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L248 nsamples</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">nsamples</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L257 split_samples</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">split_samples</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([0]), array([1]))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L268 isleaf</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">isleaf</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L271 isclassifier</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([ True])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L287 prediction_name</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">prediction_name</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L298 class_counts</span>
<span class="n">shadow_tree_node0</span><span class="o">.</span><span class="n">class_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../../posts/split-up-dtreeviz-part-2/" class="u-url">Split Up: dtreevis (Part 2)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                h1ros
            </span></p>
            <p class="dateline">
            <a href="../../posts/split-up-dtreeviz-part-2/" rel="bookmark">
            <time class="published dt-published" datetime="2019-07-17T05:51:04-07:00" itemprop="datePublished" title="Jul 17, 2019, 5:51:04 AM">Jul 17, 2019, 5:51:04 AM</time></a>
            </p>
                <p class="commentline">
        
    <a href="../../posts/split-up-dtreeviz-part-2/#disqus_thread" data-disqus-identifier="cache/posts/split-up-dtreeviz-part-2.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal">Goal<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Goal">¶</a>
</h2>
<p>This post aims to break down the module <a href="https://github.com/parrt/dtreeviz"><code>dtreeviz</code></a> module step by step to fully understand what is implemented. After fully understanding this, I would like to contribute to this module and submit a pull request.</p>
<p>I really like this module and would like to see this works for other tree-based modules like XGBoost or Lightgbm. I found <a href="https://github.com/parrt/dtreeviz/issues/15">the exact same issue (issues 15)</a> in github so I hope I could contribute to this issue.</p>
<p>This post is the 2nd part of the process of breaking down <code>ShadowDecTree</code>.</p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://github.com/parrt/dtreeviz">Github dtreeviz</a></li>
<li><a href="https://h1ros.github.io/posts/split-up-dtreeviz-part-1/">Step by Step Data Science - Split-Up: dtreeviz (Part 1)</a></li>
<li><a href="https://scikit-learn.org/stable/modules/tree.html">Scikit-Learn - Tree</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ShadowDecTree-class">
<code>ShadowDecTree</code> class<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#ShadowDecTree-class">¶</a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Source-github">Source <a href="https://github.com/parrt/dtreeviz/blob/master/dtreeviz/shadow.py">github</a><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Source-github">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="k">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="k">import</span> <span class="n">compute_class_weight</span>
<span class="kn">from</span> <span class="nn">dtreeviz.shadow</span> <span class="k">import</span> <span class="n">ShadowDecTreeNode</span> 


<span class="k">class</span> <span class="nc">ShadowDecTree</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    The decision trees for classifiers and regressors from scikit-learn</span>
<span class="sd">    are built for efficiency, not ease of tree walking. This class</span>
<span class="sd">    is intended as a way to wrap all of that information in an easy to use</span>
<span class="sd">    package.</span>
<span class="sd">    This tree shadows a decision tree as constructed by scikit-learn's</span>
<span class="sd">    DecisionTree(Regressor|Classifier).  As part of build process, the</span>
<span class="sd">    samples considered at each decision node or at each leaf node are</span>
<span class="sd">    saved as a big dictionary for use by the nodes.</span>
<span class="sd">    Field leaves is list of shadow leaf nodes. Field internal is list of</span>
<span class="sd">    shadow non-leaf nodes.</span>
<span class="sd">    Field root is the shadow tree root.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    class_names : (List[str],Mapping[int,str]). A mapping from target value</span>
<span class="sd">                  to target class name. If you pass in a list of strings,</span>
<span class="sd">                  target value i must be associated with class name[i]. You</span>
<span class="sd">                  can also pass in a dict that maps value to name.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree_model</span><span class="p">,</span>
                 <span class="n">X_train</span><span class="p">,</span>
                 <span class="n">y_train</span><span class="p">,</span>
                 <span class="n">feature_names</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">class_names</span> <span class="p">:</span> <span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">])</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree_model</span> <span class="o">=</span> <span class="n">tree_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">feature_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_names</span> <span class="o">=</span> <span class="n">class_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_weight</span> <span class="o">=</span> <span class="n">tree_model</span><span class="o">.</span><span class="n">class_weight</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">tree_model</span><span class="p">,</span> <span class="s1">'tree_'</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># make sure model is fit</span>
            <span class="n">tree_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">class_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_names</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_names</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">class_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_names</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">f</span><span class="s2">"class_names must be dict or sequence, not </span><span class="si">{self.class_names.__class__.__name__}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_to_samples</span> <span class="o">=</span> <span class="n">ShadowDecTree</span><span class="o">.</span><span class="n">node_samples</span><span class="p">(</span><span class="n">tree_model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unique_target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">class_weights</span> <span class="o">=</span> <span class="n">compute_class_weight</span><span class="p">(</span><span class="n">tree_model</span><span class="o">.</span><span class="n">class_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_target_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span>
        <span class="n">children_left</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">children_left</span>
        <span class="n">children_right</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">children_right</span>

        <span class="c1"># use locals not args to walk() for recursion speed in python</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">internal</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># non-leaf nodes</span>

        <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="n">node_id</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">children_left</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">children_right</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># leaf</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">ShadowDecTreeNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">)</span>
                <span class="n">leaves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">t</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># decision node</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="n">children_left</span><span class="p">[</span><span class="n">node_id</span><span class="p">])</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="n">children_right</span><span class="p">[</span><span class="n">node_id</span><span class="p">])</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">ShadowDecTreeNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
                <span class="n">internal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">t</span>

        <span class="n">root_node_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># record root to actual shadow nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="n">root_node_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span> <span class="o">=</span> <span class="n">leaves</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal</span> <span class="o">=</span> <span class="n">internal</span>

    <span class="k">def</span> <span class="nf">nclasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">nnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">"Return total nodes in the tree"</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">node_count</span>

    <span class="k">def</span> <span class="nf">leaf_sample_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_node_samples</span><span class="p">[</span><span class="n">leaf</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">isclassifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_model</span><span class="o">.</span><span class="n">tree_</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">&gt;</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">get_split_node_heights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nbins</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">class_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_target_values</span>
        <span class="n">node_heights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># print(f"Goal {nbins} bins")</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal</span><span class="p">:</span>
            <span class="c1"># print(node.feature_name(), node.id)</span>
            <span class="n">X_feature</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">()]</span>
            <span class="n">overall_feature_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X_feature</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X_feature</span><span class="p">))</span>
            <span class="c1"># print(f"range {overall_feature_range}")</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">overall_feature_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nbins</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># bins = np.arange(overall_feature_range[0],</span>
            <span class="c1">#                  overall_feature_range[1] + binwidth, binwidth)</span>
            <span class="c1"># print(f"\tlen(bins)={len(bins):2d} bins={bins}")</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X_feature</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">samples</span><span class="p">()],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">samples</span><span class="p">()]</span>
            <span class="n">X_hist</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">cl</span><span class="p">]</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">class_values</span><span class="p">]</span>
            <span class="n">height_of_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nbins</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">class_values</span><span class="p">:</span>
                <span class="n">hist</span><span class="p">,</span> <span class="n">foo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">X_hist</span><span class="p">[</span><span class="n">cl</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">overall_feature_range</span><span class="p">)</span>
                <span class="c1"># print(f"class {cl}: goal_n={len(bins):2d} n={len(hist):2d} {hist}")</span>
                <span class="n">height_of_bins</span> <span class="o">+=</span> <span class="n">hist</span>
            <span class="n">node_heights</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">height_of_bins</span><span class="p">)</span>

            <span class="c1"># print(f"\tmax={np.max(height_of_bins):2.0f}, heights={list(height_of_bins)}, {len(height_of_bins)} bins")</span>
        <span class="k">return</span> <span class="n">node_heights</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Number</span><span class="p">,</span><span class="n">List</span><span class="p">]:</span>
        <span class="sd">"""</span>
<span class="sd">        Given an x-vector of features, return predicted class or value based upon</span>
<span class="sd">        this tree. Also return path from root to leaf as 2nd value in return tuple.</span>
<span class="sd">        Recursively walk down tree from root to appropriate leaf by</span>
<span class="sd">        comparing feature in x to node's split value. Also return</span>
<span class="sd">        :param x: Feature vector to run down the tree to a leaf.</span>
<span class="sd">        :type x: np.ndarray</span>
<span class="sd">        :return: Predicted class or value based</span>
<span class="sd">        :rtype: Number</span>
<span class="sd">        """</span>
        <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">isleaf</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">t</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">feature</span><span class="p">()]</span> <span class="o">&lt;</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">leaf</span><span class="o">.</span><span class="n">prediction</span><span class="p">(),</span> <span class="n">path</span>

    <span class="k">def</span> <span class="nf">tesselation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Walk tree and return list of tuples containing a leaf node and bounding box</span>
<span class="sd">        list of (x1,y1,x2,y2) coordinates</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        """</span>
        <span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">bbox</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="c1"># print(f"Node {t.id} bbox {bbox} {'   LEAF' if t.isleaf() else ''}")</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">isleaf</span><span class="p">():</span>
                <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">bbox</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">t</span>
            <span class="c1"># shrink bbox for left, right and recurse</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">feature</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>  <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">,</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>  <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">s</span><span class="p">))</span>
                <span class="n">walk</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">,</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

        <span class="c1"># create bounding box in feature space (not zeroed)</span>
        <span class="n">f1_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">f2_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">overall_bbox</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">f1_values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">f2_values</span><span class="p">),</span> <span class="c1"># x,y of lower left edge</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">f1_values</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">f2_values</span><span class="p">))</span> <span class="c1"># x,y of upper right edge</span>
        <span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">overall_bbox</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bboxes</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">node_samples</span><span class="p">(</span><span class="n">tree_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
        <span class="sd">"""</span>
<span class="sd">        Return dictionary mapping node id to list of sample indexes considered by</span>
<span class="sd">        the feature/split decision.</span>
<span class="sd">        """</span>
        <span class="c1"># Doc say: "Return a node indicator matrix where non zero elements</span>
        <span class="c1">#           indicates that the samples goes through the nodes."</span>
        <span class="n">dec_paths</span> <span class="o">=</span> <span class="n">tree_model</span><span class="o">.</span><span class="n">decision_path</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># each sample has path taken down tree</span>
        <span class="n">node_to_samples</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sample_i</span><span class="p">,</span> <span class="n">dec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dec_paths</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">nz_nodes</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">node_id</span> <span class="ow">in</span> <span class="n">nz_nodes</span><span class="p">:</span>
                <span class="n">node_to_samples</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_i</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">node_to_samples</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Instantiate-class-objects">Instantiate class objects<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Instantiate-class-objects">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-a-tree-model-by-scikit-learn">Create a tree model by scikit learn<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Create-a-tree-model-by-scikit-learn">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">graphviz</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># Y = [0, 1]</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                     <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  
                     <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'0'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">],</span>  
                     <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  
                     <span class="n">special_characters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>  
<span class="n">graph</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[93]:</div>



<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: Tree Pages: 1 --><svg width="220pt" height="211pt" viewbox="0.00 0.00 219.54 211.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 207.2)"><title>Tree</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-207.2 215.5378,-207.2 215.5378,4 -4,4"></polygon><!-- 0 --><g id="node1" class="node"><title>0</title>
<path fill="transparent" stroke="#000000" d="M141.3078,-203.2C141.3078,-203.2 69.23,-203.2 69.23,-203.2 63.23,-203.2 57.23,-197.2 57.23,-191.2 57.23,-191.2 57.23,-123.2 57.23,-123.2 57.23,-117.2 63.23,-111.2 69.23,-111.2 69.23,-111.2 141.3078,-111.2 141.3078,-111.2 147.3078,-111.2 153.3078,-117.2 153.3078,-123.2 153.3078,-123.2 153.3078,-191.2 153.3078,-191.2 153.3078,-197.2 147.3078,-203.2 141.3078,-203.2"></path><text text-anchor="start" x="82.7002" y="-186.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 ≤ 0.5</text><text text-anchor="start" x="76.6739" y="-169.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.5</text><text text-anchor="start" x="67.3422" y="-153" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 2</text><text text-anchor="start" x="65" y="-136.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [1, 1]</text><text text-anchor="start" x="77.4551" y="-119.4" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 0</text></g><!-- 1 --><g id="node2" class="node"><title>1</title>
<path fill="#e58139" stroke="#000000" d="M84.3078,-75.3003C84.3078,-75.3003 12.23,-75.3003 12.23,-75.3003 6.23,-75.3003 .23,-69.3003 .23,-63.3003 .23,-63.3003 .23,-11.8997 .23,-11.8997 .23,-5.8997 6.23,.1003 12.23,.1003 12.23,.1003 84.3078,.1003 84.3078,.1003 90.3078,.1003 96.3078,-5.8997 96.3078,-11.8997 96.3078,-11.8997 96.3078,-63.3003 96.3078,-63.3003 96.3078,-69.3003 90.3078,-75.3003 84.3078,-75.3003"></path><text text-anchor="start" x="19.6739" y="-58.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.0</text><text text-anchor="start" x="10.3422" y="-41.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 1</text><text text-anchor="start" x="8" y="-25" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [1, 0]</text><text text-anchor="start" x="20.4551" y="-8.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 0</text></g><!-- 0&#45;&gt;1 --><g id="edge1" class="edge"><title>0-&gt;1</title>
<path fill="none" stroke="#000000" d="M83.2312,-110.9595C79.0901,-102.2704 74.7568,-93.1781 70.6066,-84.47"></path><polygon fill="#000000" stroke="#000000" points="73.6547,-82.7302 66.1928,-75.2088 67.3356,-85.7419 73.6547,-82.7302"></polygon><text text-anchor="middle" x="57.8402" y="-94.5722" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">True</text></g><!-- 2 --><g id="node3" class="node"><title>2</title>
<path fill="#399de5" stroke="#000000" d="M199.3078,-75.3003C199.3078,-75.3003 127.23,-75.3003 127.23,-75.3003 121.23,-75.3003 115.23,-69.3003 115.23,-63.3003 115.23,-63.3003 115.23,-11.8997 115.23,-11.8997 115.23,-5.8997 121.23,.1003 127.23,.1003 127.23,.1003 199.3078,.1003 199.3078,.1003 205.3078,.1003 211.3078,-5.8997 211.3078,-11.8997 211.3078,-11.8997 211.3078,-63.3003 211.3078,-63.3003 211.3078,-69.3003 205.3078,-75.3003 199.3078,-75.3003"></path><text text-anchor="start" x="134.6739" y="-58.6" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">gini = 0.0</text><text text-anchor="start" x="125.3422" y="-41.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">samples = 1</text><text text-anchor="start" x="123" y="-25" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">value = [0, 1]</text><text text-anchor="start" x="135.4551" y="-8.2" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">class = 1</text></g><!-- 0&#45;&gt;2 --><g id="edge2" class="edge"><title>0-&gt;2</title>
<path fill="none" stroke="#000000" d="M127.6932,-110.9595C131.907,-102.2704 136.3163,-93.1781 140.5393,-84.47"></path><polygon fill="#000000" stroke="#000000" points="143.8162,-85.7339 145.0305,-75.2088 137.5178,-82.6794 143.8162,-85.7339"></polygon><text text-anchor="middle" x="153.2229" y="-94.6284" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">False</text></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-a-ShadowDecTree">Create a <code>ShadowDecTree</code><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Create-a-ShadowDecTree">¶</a>
</h3>
<p><strong>ShadowDecTree</strong> <code>__init__</code></p>
<ul>
<li>L33-41: define <code>__initi__</code> with 5 input arguments.</li>
<li>L38-41: store the input arguments as a class member</li>
<li>
<p>L43-44: check if the trained model exists in <code>tree_model</code>, and if not, it enforces to train the tree model.</p>
</li>
<li>
<p>L46-52: treatment for multi label classification</p>
</li>
<li>
<p>L54-59: treatment for <code>pandas</code> if <code>pandas.DataFrame</code> is used for <code>X_train</code> and <code>y_train</code>. Convert them into <code>np.array</code></p>
</li>
<li>
<p>L60: a static method <code>node_samples</code> in <code>ShadowDecTree</code> to create a map from node id in tree_model to list of sample indices.</p>
</li>
<li>
<p>L61-63: treatment for target values and class weights if tree_model is for classification</p>
</li>
<li>
<p>L65-71: preparation for re-organizing tree object into the one for dtreeviz</p>
</li>
<li>
<p>L73-83: define the recursive function to walk through nodes by post order traversal through Depth-First Search (DFS) algorithm.</p>
</li>
<li>
<p>L85-89: execute <code>walk</code> method from the root node. Store a list of end nodes as <code>leaves</code> and a list of intermediate nodes as <code>internal</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instantiate ShadowDecTree</span>
<span class="n">shadow_tree</span> <span class="o">=</span> <span class="n">ShadowDecTree</span><span class="p">(</span><span class="n">tree_model</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y_train</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A root node</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">root</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[95]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.ShadowDecTreeNode at 0x1216dd4a8&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A list of end nodes </span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">leaves</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[96]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;__main__.ShadowDecTreeNode at 0x121696470&gt;,
 &lt;__main__.ShadowDecTreeNode at 0x1216dd940&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A list of internal nodes</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">internal</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[97]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;__main__.ShadowDecTreeNode at 0x1216dd4a8&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A mapping from node id to sample id</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">node_to_samples</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[98]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>defaultdict(list, {0: [0, 1], 1: [0], 2: [1]})</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Other-methods-for-ShadowDecTree">Other methods for <code>ShadowDecTree</code><a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Other-methods-for-ShadowDecTree">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [99]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L91 nclasses</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">nclasses</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[99]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L94 nnodes</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">nnodes</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[100]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L98 leaf_sample_counts</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">leaf_sample_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[101]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[1, 1]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L101 isclassifier</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">isclassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[102]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([ True])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L104 get_split_node_heights</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">get_split_node_heights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y_train</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[103]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{0: 1.0}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"shadow_tree.internal[0].feature(): {shadow_tree.internal[0].feature()}"</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:,</span> <span class="n">shadow_tree</span><span class="o">.</span><span class="n">internal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">feature</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>shadow_tree.internal[0].feature(): 1
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[104]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L132 predict</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[105]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(1,
 [&lt;__main__.ShadowDecTreeNode at 0x1216dd4a8&gt;,
  &lt;__main__.ShadowDecTreeNode at 0x1216dd940&gt;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># L158 tesselation</span>
<span class="n">shadow_tree</span><span class="o">.</span><span class="n">tesselation</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[106]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[(&lt;__main__.ShadowDecTreeNode at 0x121696470&gt;, (0, 0, 1, 0.5)),
 (&lt;__main__.ShadowDecTreeNode at 0x1216dd940&gt;, (0, 0.5, 1, 1))]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Opportunity-to-contribute">Opportunity to contribute<a class="anchor-link" href="../../posts/split-up-dtreeviz-part-2/#Opportunity-to-contribute">¶</a>
</h3>
<p>Through line-by-line execution, I found the following opportunities I could potentially contribute to.</p>
<ul>
<li>Add documentation for each methods</li>
<li>Add validation if it is <code>np.array</code> or not for <code>X_train</code> and <code>y_train</code> since when I pass the list as <code>X_train</code> and <code>y_train</code>, I got the error for <code>get_split_node_heights</code> and <code>tesselation</code> like below:
<img src="https://user-images.githubusercontent.com/8764683/61387320-e5a62880-a8f0-11e9-874b-7228527abd0a.png" alt="image">
</li>
</ul>
</div>
</div>
</div>
</div>
    </div>
    </article>
</div>



        
       <script>var disqus_shortname="https-h1ros-github-io";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2022         <a href="mailto:data.h1ros@gmail.com">h1ros</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'h1ros-github-io/ama'
  };
</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(1, "YYYY-MM-DD");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- GitHub Buttons --><script async defer src="https://buttons.github.io/buttons.js"></script><!-- Twitter Widgets --><script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);
  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };
  return t;
}(document, "script", "twitter-wjs"));</script>
</body>
</html>
