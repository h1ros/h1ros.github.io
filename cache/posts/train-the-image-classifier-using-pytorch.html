
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Goal">Goal<a class="anchor-link" href="#Goal">&#182;</a></h1><p>This post aims to introduce how to train the image classifier for MNIST dataset using PyTorch</p>
<p><strong>Reference</strong></p>
<ul>
<li><a href="https://pytorch.org/docs/stable/torchvision/datasets.html#mnist">PyTorch Documentation - TORCHVISION.DATASETS</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">PyTorch Tutorial - TRAINING A CLASSIFIER</a></li>
<li><a href="https://www.kaggle.com/sdelecourt/cnn-with-pytorch-for-mnist">Kaggle kernel - CNN with Pytorch for MNIST </a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Libraries">Libraries<a class="anchor-link" href="#Libraries">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_digits</span>

<span class="c1"># PyTorch</span>
<span class="kn">import</span> <span class="nn">torch</span> 
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>

<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Functions">Functions<a class="anchor-link" href="#Functions">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="c1"># unnormalize</span>
    <span class="n">npimg</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">npimg</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-MNIST-dataset">Load MNIST dataset<a class="anchor-link" href="#Load-MNIST-dataset">&#182;</a></h1><p>When downloading the image dataset, we also need to define <code>transform</code> function that apply pixel normalization from [0, 1] to [-1, +1]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
     <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">))])</span>

<span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data&#39;</span><span class="p">,</span> 
                                        <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

<span class="n">testset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;~/data&#39;</span><span class="p">,</span> 
                                        <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                        <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                        <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>
9920512it [00:28, 1582029.76it/s]                             

1654784it [00:23, 573182.07it/s]                             </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-dataloader">Create a dataloader<a class="anchor-link" href="#Create-a-dataloader">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">trainset</span><span class="p">,</span>
                                          <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                          <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">testset</span><span class="p">,</span>
                                         <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                         <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Define-a-model">Define a model<a class="anchor-link" href="#Define-a-model">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 28x28x32 -&gt; 26x26x32</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 26x26x64 -&gt; 24x24x64</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 24x24x64 -&gt; 12x12x64</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout2d</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout2d</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">64</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Create-a-loss-function-and-optimizer">Create a loss function and optimizer<a class="anchor-link" href="#Create-a-loss-function-and-optimizer">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training-a-model">Training a model<a class="anchor-link" href="#Training-a-model">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># zero the parameter gradients</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="c1"># forward + backward + optimize</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># print statistics</span>
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">99</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[{epoch + 1}, {i+1}] loss: {running_loss / 100:.2}&#39;</span><span class="p">)</span>
            <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished Training&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1, 100] loss: 1.5
[1, 200] loss: 0.82
[1, 300] loss: 0.63
[1, 400] loss: 0.55
[1, 500] loss: 0.5
[1, 600] loss: 0.46
[2, 100] loss: 0.42
[2, 200] loss: 0.4
[2, 300] loss: 0.38
[2, 400] loss: 0.38
[2, 500] loss: 0.34
[2, 600] loss: 0.34
[3, 100] loss: 0.31
[3, 200] loss: 0.31
[3, 300] loss: 0.29
[3, 400] loss: 0.28
[3, 500] loss: 0.28
[3, 600] loss: 0.26
[4, 100] loss: 0.24
[4, 200] loss: 0.24
[4, 300] loss: 0.24
[4, 400] loss: 0.23
[4, 500] loss: 0.23
[4, 600] loss: 0.22
[5, 100] loss: 0.2
[5, 200] loss: 0.21
[5, 300] loss: 0.2
[5, 400] loss: 0.19
[5, 500] loss: 0.19
[5, 600] loss: 0.19
Finished Training
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Test">Test<a class="anchor-link" href="#Test">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">testloader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_test</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Ground Truth&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">[:</span><span class="n">n_test</span><span class="p">],</span>
    <span class="s1">&#39;Predicted label&#39;</span><span class="p">:</span> <span class="n">predicted</span><span class="p">[:</span><span class="n">n_test</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">[:</span><span class="n">n_test</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">nrow</span><span class="o">=</span><span class="n">n_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ground Truth</th>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Predicted label</th>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
 

